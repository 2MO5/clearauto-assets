!function(e){e.vinCardsInit=function(e){"use strict";function t(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e,{once:!0}):e()}function n(t){if(e.gsap&&e.ScrollTrigger)return e.gsap.registerPlugin(e.ScrollTrigger),t();const n=setInterval(()=>{e.gsap&&e.ScrollTrigger&&(clearInterval(n),e.gsap.registerPlugin(e.ScrollTrigger),t())},30);setTimeout(()=>{clearInterval(n),console.warn("[vin] GSAP not found after 10s")},1e4)}const a={deferred:[]};function r(){const t=".scroll-stack-section",n=".card-stack-container",i=".card-benefit",o=".ca-vin-input-section",s=document.querySelector(t),c=document.querySelector(n),l=gsap.utils.toArray(`${t} ${i}`);if(!s||!c||0===l.length||"1"===c.dataset.vinInit){if(!c||"1"===c.dataset.vinRetry)return;return c&&(c.dataset.vinRetry="1"),void setTimeout(()=>{try{r()}catch(e){console.warn("[vin] retry failed",e)}},120)}if(!s||!c||0===l.length||"1"===c.dataset.vinInit)return;c.dataset.vinInit="1";const u=()=>e.matchMedia("(min-width: 992px)").matches,d=()=>u()?90:40;let p=u();function g(e){p=!e&&u()}gsap.set(c,{position:"relative",height:Math.min(.6*e.innerHeight,640),overflow:"hidden"}),gsap.set(l,{position:"absolute",inset:0,margin:"auto",transformOrigin:"50% 70%",willChange:"transform,opacity",zIndex:0}),l.forEach((e,t)=>{t<3?gsap.set(e,{opacity:1-.15*t,scale:1-.05*t,y:36*t,zIndex:l.length-t}):gsap.set(e,{opacity:0,scale:.86,y:108,zIndex:0})});const f=l.length,h=.95,y="power3.out",v=460;function m(e){l.forEach((t,n)=>{n===e?(t.classList.add("is-active"),t.setAttribute("aria-hidden","false"),t.style.pointerEvents="auto"):(t.classList.remove("is-active"),t.setAttribute("aria-hidden","true"),t.style.pointerEvents="none")})}function w(e){const t=e%f,n=(e+1)%f,a=(e+2)%f;m(t),l.forEach((e,r)=>{const i=r===t?{opacity:1,scale:1,y:0,zIndex:3}:r===n?{opacity:.85,scale:.95,y:36,zIndex:2}:r===a?{opacity:.7,scale:.9,y:72,zIndex:1}:{opacity:0,scale:.86,y:108,zIndex:0};r===t?e.classList.add("ring-sweep"):e.classList.remove("ring-sweep"),gsap.to(e,{...i,duration:h,ease:y})})}w(0);const L=gsap.timeline({paused:!0});for(let e=0;e<f;e++)L.add(()=>w(e),e);w(0);const E=(e,t,n)=>Math.max(t,Math.min(n,e)),S=e=>p?(e%f+f)%f:E(e,0,f-1);let x=0,I=0,T=!1;const b=ScrollTrigger.getScrollFunc(e),k=()=>{const t=Math.max(f-1,1),n=.9*e.innerHeight,a=.6*e.innerHeight;return Math.max(e.innerHeight,t*n+a)/t};function A(t){if(T)return;const n=performance.now();if(n-I<v)return;T=!0,I=n;const a=x;if(x=S(t),gsap.killTweensOf(L),gsap.to(L,{time:x,duration:h,ease:y,onComplete:()=>{T=!1}}),!u()&&e.__vinPinST&&e.__vinPinST.isActive){const e=x>a?1:x<a?-1:0;if(0!==e){const t=k(),n=b();b(n+e*t)}}}function M(){a.deferred.forEach(e=>{e._armed||(e._armed=!0,gsap.delayedCall(1.05,()=>{e.ctaTL._played||(e.ctaTL.play(),e.ctaTL._played=!0)}))})}const P=document.querySelector(o)?o:t,H=1.2*e.innerHeight,_=.6*e.innerHeight,q=f-1;let D;D=u()?Math.max(e.innerHeight,q*H/2+_):Math.max(e.innerHeight,q*(.9*e.innerHeight)+_);const z=ScrollTrigger.create({trigger:P,start:"30% top",end:()=>"+="+D,pin:!0,pinSpacing:!0,anticipatePin:1,onEnter:()=>{g(!0),U()},onEnterBack:()=>{g(!0),U()},onLeave:()=>{j(),g(!1),M()},onLeaveBack:()=>{j(),g(!1)}});e.__vinPinST=z;let O=null,C=0;const R=()=>!p&&0===x,$=()=>!p&&x===f-1;function Y(e){C+=e,Math.abs(C)>=d()&&(T||A(C>0?x+1:x-1),C=0)}function B(e){const t=e.deltaY;$()&&t>0||R()&&t<0||(e.preventDefault(),Y(t))}function U(){e.addEventListener("wheel",B,{passive:!1}),e.addEventListener("touchstart",F,{passive:!0}),e.addEventListener("touchmove",G,{passive:!1}),e.addEventListener("touchend",V,{passive:!0}),e.addEventListener("keydown",J)}function j(){e.removeEventListener("wheel",B,{passive:!1}),e.removeEventListener("touchstart",F,{passive:!0}),e.removeEventListener("touchmove",G,{passive:!1}),e.removeEventListener("touchend",V,{passive:!0}),e.removeEventListener("keydown",J),C=0,O=null}function F(e){O=e.touches&&e.touches.length?e.touches[0].clientY:null}function G(e){if(null==O)return;const t=e.touches[0].clientY,n=O-t;O=t,$()&&n>0||R()&&n<0||(e.preventDefault(),Y(n))}function V(){O=null,C=0}function J(e){"ArrowDown"!==e.key&&"PageDown"!==e.key||(e.preventDefault(),A(x+1)),"ArrowUp"!==e.key&&"PageUp"!==e.key||(e.preventDefault(),A(x-1))}function K(){gsap.set(c,{height:Math.min(.6*e.innerHeight,640)});const t=e.innerHeight,n=1.2*t,a=.9*t,r=.6*t;let i;i=u()?Math.max(t,q*n/2+r):Math.max(t,q*a+r),z.vars.end="+="+i,z.refresh(),g(z.isActive)}e.addEventListener("resize",K)}function i(){const e=".scroll-stack-section",t=".ca-vin-input-section",n=".card-stack-container",a=".ca-cta-block",r=document.querySelector(e);if(!r||"1"===r.dataset.secIntroInit)return;r.dataset.secIntroInit="1";const i=r.querySelector(t),o=r.querySelector(n),s=Array.from(r.children).filter(e=>e!==i&&e!==o&&!e.matches(a));[...s,o].forEach(e=>{e&&(e.style.removeProperty("transform"),e.style.removeProperty("opacity"))});const c=gsap.timeline({paused:!0,defaults:{duration:.7,ease:"power3.out",overwrite:"auto"}});s.length&&c.from(s,{y:24,opacity:0,stagger:{each:.07,from:"start"},force3D:!0},0),o&&c.from(o,{y:16,opacity:0,duration:.6,ease:"power2.out",force3D:!0},.1),ScrollTrigger.create({trigger:r,start:"top 85%",end:"top 65%",once:!0,onEnter:()=>c.play().then(()=>{gsap.set(s,{clearProps:"transform,opacity,will-change"}),o&&gsap.set(o,{clearProps:"transform,opacity,will-change"})})})}function o(){const t=document.querySelectorAll(".ca-cta-block");t.length&&!e.matchMedia("(prefers-reduced-motion: reduce)").matches&&t.forEach(e=>{if("1"===e.dataset.ctaInit)return;e.dataset.ctaInit="1";const t=".ca-heading-cta",n=".ca-button--primary-2.cta-style",r=".ca-cta-socialstrip .users",i=".ca-cta-socialstrip h1, .ca-cta-socialstrip .stat";gsap.context(o=>{const s=o.selector,c=s(t)[0];let l=[];if(c&&!c.querySelector(".w")){const e=c.textContent.trim().split(/\s+/);c.innerHTML=e.map(e=>`<span class="w">${e}&nbsp;</span>`).join(""),l=c.querySelectorAll(".w")}else c&&(l=c.querySelectorAll(".w"));gsap.set(l.length?l:s(t),{opacity:0,y:24,filter:"blur(6px)"}),gsap.set(s(n),{opacity:0,y:18,scale:.98,filter:"blur(6px)"});const u=s(`${r} img`);u.length?gsap.set(u,{opacity:0,y:16,x:-8,rotate:-6,transformOrigin:"50% 50%"}):gsap.set(s(r),{opacity:0,y:16}),gsap.set(s(i),{opacity:0,y:12});const d=e.hasAttribute("data-cta-defer"),p=e.dataset.ctaStart||"top 75%",g=e.dataset.ctaEnd||null,f=e.classList.contains("ca-cta-center"),h={ease:"power3.out"},y=g?{trigger:e,start:p,end:g,once:!0,invalidateOnRefresh:!0}:{trigger:e,start:p,once:!0,invalidateOnRefresh:!0},v=gsap.timeline(d?{paused:!0,defaults:h}:{defaults:h,scrollTrigger:y});v.to(l.length?l:s(t),{opacity:1,y:0,filter:"blur(0px)",duration:.7,stagger:l.length?{each:.06,from:"start"}:0}).fromTo(s(n),{autoAlpha:0,y:18,scale:.98,filter:"blur(6px)"},{autoAlpha:1,y:0,scale:1,filter:"blur(0px)",duration:.55,overwrite:"auto"},"-=0.2").to(u.length?u:s(r),{opacity:1,y:0,x:0,rotate:0,duration:.5,stagger:u.length?{each:.07,from:f?"center":"start"}:0},"-=0.15").to(s(i),{opacity:1,y:0,duration:.4},"-=0.25");const m=s(n)[0];if(m){const e=gsap.to(m,{scale:1.008,duration:1.8,repeat:-1,yoyo:!0,ease:"sine.inOut"});m.addEventListener("mouseenter",()=>e.pause()),m.addEventListener("mouseleave",()=>e.resume()),v.add(()=>e.play())}u.length&&gsap.to(u,{y:"+=4",duration:2.2,repeat:-1,yoyo:!0,ease:"sine.inOut",stagger:{each:.2,from:"random"}}),d&&a.deferred.push({ctaTL:v,block:e,_armed:!1})},e)})}function s(){t(()=>{n(()=>{r(),i(),o()})})}return e.clearautoVinCardsInit=s,s}(e)}(window);